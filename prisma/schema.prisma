generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model Usuario {
  id                   Int      @id @default(autoincrement())
  nombre               String   @db.NVarChar(50)
  usuario              String   @unique @db.NVarChar(50)
  contrasena           String   @db.NVarChar(255)
  correo               String   @unique @db.NVarChar(100)
  estado               Boolean  @default(true)
  fecha_creacion       DateTime @default(now())
  fecha_actualizacion  DateTime @updatedAt
  
  // Relación con Licencia
  licencias            Licencia[]
  
  @@map("Usuario")
}

model Servicio {
  id                   Int      @id @default(autoincrement())
  fecha_inicio         DateTime
  fecha_fin            DateTime
  precio               Decimal  @db.Decimal(10, 2)
  fecha_creacion       DateTime @default(now())
  fecha_actualizacion  DateTime @updatedAt
  
  // Relación con Licencia
  licencias            Licencia[]
  
  @@map("Servicio")
}

model Licencia {
  id                   Int      @id @default(autoincrement())
  id_usuario           Int
  id_servicio          Int
  caducidad            DateTime @db.Date
  estado               Boolean  @default(true)
  fecha_creacion       DateTime @default(now())
  fecha_actualizacion  DateTime @updatedAt
  
  // Relaciones
  usuario              Usuario  @relation(fields: [id_usuario], references: [id], onDelete: Cascade)
  servicio             Servicio @relation(fields: [id_servicio], references: [id], onDelete: Cascade)
  
  // Restricción única
  @@unique([id_usuario, id_servicio])
  @@map("Licencia")
}